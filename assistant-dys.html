<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mon Assistant Dys</title>
    <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #F4A460;
            --secondary: #8FB886;
            --accent: #FFD700;
            --dark: #5C4033;
            --light: #FFF9E6;
            --success: #8FB886;
            --warning: #F4A460;
            --info: #87CEEB;
            --shadow: rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #87CEEB 0%, #FFE5B4 50%, #FFD700 100%);
            min-height: 100vh;
            padding: 20px;
            color: var(--dark);
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                radial-gradient(circle at 20% 30%, rgba(255, 255, 255, 0.3) 0%, transparent 2%),
                radial-gradient(circle at 60% 70%, rgba(255, 255, 255, 0.2) 0%, transparent 2%),
                radial-gradient(circle at 80% 20%, rgba(255, 255, 255, 0.3) 0%, transparent 1.5%),
                radial-gradient(circle at 40% 80%, rgba(255, 255, 255, 0.2) 0%, transparent 1.5%),
                radial-gradient(circle at 90% 60%, rgba(255, 255, 255, 0.25) 0%, transparent 2%);
            pointer-events: none;
            z-index: 0;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
            animation: slideDown 0.5s ease-out;
            background: rgba(255, 255, 255, 0.9);
            padding: 30px;
            border-radius: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255, 215, 0, 0.3);
        }

        .logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }

        .logo-img {
            width: 120px;
            height: auto;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        h1 {
            font-size: 3rem;
            color: var(--primary);
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            margin: 0;
            font-weight: 700;
        }

        .subtitle {
            color: var(--secondary);
            font-size: 1.2rem;
            font-weight: 500;
            margin-top: 10px;
        }

        .tabs {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            animation: slideUp 0.5s ease-out 0.2s both;
        }

        .tab-btn {
            background: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px var(--shadow);
            font-family: 'Poppins', sans-serif;
            color: var(--dark);
        }

        .tab-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.2);
        }

        .tab-btn.active {
            background: var(--primary);
            color: white;
            transform: scale(1.05);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease-out;
        }

        .tab-content.active {
            display: block;
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.08);
            transition: transform 0.3s ease;
            border: 2px solid rgba(244, 164, 96, 0.2);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(0,0,0,0.12);
        }

        .card-title {
            font-size: 1.5rem;
            color: var(--primary);
            margin-bottom: 20px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .emoji {
            font-size: 1.8rem;
        }

        input, textarea, select {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1rem;
            font-family: 'Poppins', sans-serif;
            margin-bottom: 15px;
            transition: border-color 0.3s ease;
        }

        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--secondary);
        }

        textarea {
            min-height: 100px;
            resize: vertical;
        }

        button {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Poppins', sans-serif;
        }

        button:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .task-list {
            display: grid;
            gap: 15px;
        }

        .task-item {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 20px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            gap: 15px;
            transition: all 0.3s ease;
            animation: slideIn 0.3s ease-out;
        }

        .task-item:hover {
            transform: translateX(10px);
        }

        .task-item.completed {
            opacity: 0.6;
            text-decoration: line-through;
        }

        .task-checkbox {
            width: 24px;
            height: 24px;
            cursor: pointer;
        }

        .task-content {
            flex: 1;
        }

        .task-priority {
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 700;
            text-transform: uppercase;
        }

        .priority-urgent {
            background: var(--primary);
            color: white;
        }

        .priority-important {
            background: var(--warning);
            color: var(--dark);
        }

        .priority-normal {
            background: var(--success);
            color: white;
        }

        .priority-later {
            background: var(--info);
            color: white;
        }

        .delete-btn {
            background: transparent;
            color: var(--primary);
            padding: 5px 10px;
            font-size: 1.2rem;
        }

        .emotion-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .emotion-card {
            background: linear-gradient(135deg, var(--secondary) 0%, var(--info) 100%);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            color: white;
        }

        .emotion-card:hover {
            transform: scale(1.1) rotate(2deg);
        }

        .emotion-card.selected {
            background: linear-gradient(135deg, var(--primary) 0%, var(--warning) 100%);
            transform: scale(1.05);
        }

        .emotion-icon {
            font-size: 3rem;
            margin-bottom: 10px;
        }

        .problem-steps {
            display: grid;
            gap: 20px;
            margin-top: 20px;
        }

        .step {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            border-left: 5px solid var(--secondary);
        }

        .step-number {
            background: var(--secondary);
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            margin-right: 10px;
        }

        .tips-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .tip-card {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px var(--shadow);
        }

        .tip-icon {
            font-size: 2rem;
            margin-bottom: 15px;
        }

        .result-box {
            background: #e8f5e9;
            border: 2px solid var(--success);
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
            animation: fadeIn 0.5s ease-out;
        }

        .progress-bar {
            width: 100%;
            height: 10px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            margin-top: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--success) 0%, var(--secondary) 100%);
            transition: width 0.5s ease;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .grid-2 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
            }
            
            .grid-2 {
                grid-template-columns: 1fr;
            }
            
            .tabs {
                flex-direction: column;
            }
        }

        .timer-display {
            font-size: 3rem;
            font-family: 'Space Mono', monospace;
            text-align: center;
            color: var(--primary);
            margin: 20px 0;
            font-weight: 700;
        }

        .timer-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .energy-meter {
            text-align: center;
            margin: 20px 0;
        }

        .energy-level {
            font-size: 4rem;
            margin: 10px 0;
        }

        .period-btn {
            background: white;
            border: 2px solid var(--secondary);
            color: var(--dark);
            padding: 10px 20px;
            border-radius: 25px;
            margin: 0 5px;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Poppins', sans-serif;
        }

        .period-btn:hover {
            transform: translateY(-2px);
        }

        .period-btn.active {
            background: var(--secondary);
            color: white;
        }

        .milestone-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            border-left: 4px solid var(--accent);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .milestone-date {
            font-size: 0.85rem;
            color: #666;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo-container">
                <img src="logo-petit-prince.webp" alt="Le Petit Prince" class="logo-img">
                <h1>Mon Assistant Dys</h1>
            </div>
            <p class="subtitle">Du SESSAD Petit Prince</p>
        </header>

        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('tasks')">ğŸ“‹ Mes TÃ¢ches</button>
            <button class="tab-btn" onclick="switchTab('emotions')">â¤ï¸ Mes Ã‰motions</button>
            <button class="tab-btn" onclick="switchTab('stats')">ğŸ“Š Mes Statistiques</button>
            <button class="tab-btn" onclick="switchTab('problem')">ğŸ§© RÃ©soudre un ProblÃ¨me</button>
            <button class="tab-btn" onclick="switchTab('focus')">â±ï¸ Focus Timer</button>
            <button class="tab-btn" onclick="switchTab('situations')">ğŸª Situations du quotidien</button>
            <button class="tab-btn" onclick="switchTab('tips')">ğŸ’¡ Astuces Dys</button>
        </div>

        <!-- TÃ‚CHES -->
        <div id="tasks" class="tab-content active">
            <div class="grid-2">
                <div class="card">
                    <h2 class="card-title"><span class="emoji">â•</span>Ajouter une tÃ¢che</h2>
                    <input type="text" id="taskInput" placeholder="Quelle est la tÃ¢che ?" />
                    <select id="prioritySelect">
                        <option value="urgent">ğŸ”´ Urgent (Ã  faire maintenant)</option>
                        <option value="important">ğŸŸ¡ Important (aujourd'hui)</option>
                        <option value="normal" selected>ğŸŸ¢ Normal (cette semaine)</option>
                        <option value="later">ğŸ”µ Plus tard (quand possible)</option>
                    </select>
                    <button onclick="addTask()">Ajouter la tÃ¢che</button>
                </div>

                <div class="card">
                    <h2 class="card-title"><span class="emoji">ğŸ“Š</span>Mon progrÃ¨s</h2>
                    <div class="energy-meter">
                        <p><strong>TÃ¢ches complÃ©tÃ©es aujourd'hui</strong></p>
                        <div class="energy-level" id="completedCount">0</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressBar" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h2 class="card-title"><span class="emoji">ğŸ“</span>Ma liste de tÃ¢ches</h2>
                <div class="task-list" id="taskList"></div>
            </div>
        </div>

        <!-- Ã‰MOTIONS -->
        <div id="emotions" class="tab-content">
            <div class="card">
                <h2 class="card-title"><span class="emoji">ğŸ­</span>Comment je me sens ?</h2>
                <p>Clique sur l'Ã©motion qui te correspond le mieux en ce moment :</p>
                <div class="emotion-grid">
                    <div class="emotion-card" onclick="selectEmotion('joyeux', this)">
                        <div class="emotion-icon">ğŸ˜Š</div>
                        <div>Joyeux</div>
                    </div>
                    <div class="emotion-card" onclick="selectEmotion('calme', this)">
                        <div class="emotion-icon">ğŸ˜Œ</div>
                        <div>Calme</div>
                    </div>
                    <div class="emotion-card" onclick="selectEmotion('anxieux', this)">
                        <div class="emotion-icon">ğŸ˜°</div>
                        <div>Anxieux</div>
                    </div>
                    <div class="emotion-card" onclick="selectEmotion('frustrÃ©', this)">
                        <div class="emotion-icon">ğŸ˜¤</div>
                        <div>FrustrÃ©</div>
                    </div>
                    <div class="emotion-card" onclick="selectEmotion('triste', this)">
                        <div class="emotion-icon">ğŸ˜¢</div>
                        <div>Triste</div>
                    </div>
                    <div class="emotion-card" onclick="selectEmotion('dÃ©bordÃ©', this)">
                        <div class="emotion-icon">ğŸ¤¯</div>
                        <div>DÃ©bordÃ©</div>
                    </div>
                    <div class="emotion-card" onclick="selectEmotion('excitÃ©', this)">
                        <div class="emotion-icon">ğŸ¤©</div>
                        <div>ExcitÃ©</div>
                    </div>
                    <div class="emotion-card" onclick="selectEmotion('fatiguÃ©', this)">
                        <div class="emotion-icon">ğŸ˜´</div>
                        <div>FatiguÃ©</div>
                    </div>
                </div>
                <div id="emotionResult"></div>
            </div>

            <div class="card">
                <h2 class="card-title"><span class="emoji">âœï¸</span>Journal Ã©motionnel</h2>
                <textarea id="emotionJournal" placeholder="DÃ©cris ce qui se passe dans ta tÃªte en ce moment... Qu'est-ce qui a dÃ©clenchÃ© cette Ã©motion ?"></textarea>
                <button onclick="saveEmotionEntry()">Enregistrer mon ressenti</button>
                <div id="journalEntries"></div>
            </div>
        </div>

        <!-- STATISTIQUES -->
        <div id="stats" class="tab-content">
            <div class="card">
                <h2 class="card-title"><span class="emoji">ğŸ“Š</span>Mes Statistiques</h2>
                
                <!-- SÃ©lecteur de pÃ©riode -->
                <div style="text-align: center; margin-bottom: 30px;">
                    <button onclick="changeStatsPeriod('today')" id="btn-today" class="period-btn active">Aujourd'hui</button>
                    <button onclick="changeStatsPeriod('week')" id="btn-week" class="period-btn">7 derniers jours</button>
                    <button onclick="changeStatsPeriod('month')" id="btn-month" class="period-btn">30 derniers jours</button>
                </div>

                <!-- Graphique des Ã©motions -->
                <div style="background: white; padding: 25px; border-radius: 15px; margin-bottom: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
                    <h3 style="color: var(--primary); margin-bottom: 20px;">ğŸ“ˆ Ã‰volution de mes Ã©motions</h3>
                    <canvas id="emotionsChart" style="max-height: 300px;"></canvas>
                    <div id="emotionsChartLegend" style="margin-top: 15px; text-align: center;"></div>
                </div>

                <!-- Graphique des tÃ¢ches -->
                <div style="background: white; padding: 25px; border-radius: 15px; margin-bottom: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
                    <h3 style="color: var(--secondary); margin-bottom: 20px;">âœ… Progression des tÃ¢ches</h3>
                    <canvas id="tasksChart" style="max-height: 300px;"></canvas>
                </div>

                <!-- Statistiques rÃ©sumÃ©es -->
                <div class="grid-2">
                    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 25px; border-radius: 15px; color: white; text-align: center;">
                        <div style="font-size: 3rem; font-weight: 700;" id="totalTasksCompleted">0</div>
                        <div style="font-size: 1.2rem; margin-top: 10px;">TÃ¢ches complÃ©tÃ©es</div>
                        <div style="font-size: 0.9rem; opacity: 0.8; margin-top: 5px;" id="periodLabel">cette pÃ©riode</div>
                    </div>
                    
                    <div style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); padding: 25px; border-radius: 15px; color: white; text-align: center;">
                        <div style="font-size: 3rem; font-weight: 700;" id="emotionMostFrequent">-</div>
                        <div style="font-size: 1.2rem; margin-top: 10px;">Ã‰motion dominante</div>
                        <div style="font-size: 0.9rem; opacity: 0.8; margin-top: 5px;">cette pÃ©riode</div>
                    </div>
                </div>

                <!-- Points d'Ã©tape -->
                <div style="background: #f8f9fa; padding: 25px; border-radius: 15px; margin-top: 25px;">
                    <h3 style="color: var(--primary); margin-bottom: 20px;">ğŸ¯ Mes points d'Ã©tape</h3>
                    <div id="milestonesList"></div>
                    <button onclick="addMilestone()" style="margin-top: 15px;">â• Ajouter un point d'Ã©tape</button>
                </div>
            </div>
        </div>

        <!-- RÃ‰SOLUTION DE PROBLÃˆME -->
        <div id="problem" class="tab-content">
            <div class="card">
                <h2 class="card-title"><span class="emoji">ğŸ¯</span>Analyse fonctionnelle du problÃ¨me</h2>
                <p style="margin-bottom: 20px;">Cette mÃ©thode t'aide Ã  comprendre POURQUOI le comportement/problÃ¨me existe et comment le changer.</p>
                
                <div class="problem-steps">
                    <div class="step">
                        <span class="step-number">1</span>
                        <strong>Situation dÃ©clenchante (AVANT)</strong>
                        <p style="font-size: 0.9rem; color: #666; margin: 5px 0;">Qu'est-ce qui se passe juste avant le problÃ¨me ? OÃ¹ es-tu ? Que fais-tu ? Avec qui ?</p>
                        <textarea id="problemBefore" placeholder="Ex: Je suis seul dans ma chambre, je dois Ã©tudier, il est 14h aprÃ¨s le dÃ©jeuner..."></textarea>
                    </div>
                    
                    <div class="step">
                        <span class="step-number">2</span>
                        <strong>Le comportement/problÃ¨me (PENDANT)</strong>
                        <p style="font-size: 0.9rem; color: #666; margin: 5px 0;">DÃ©cris prÃ©cisÃ©ment ce que tu fais. Sois factuel et observable.</p>
                        <textarea id="problemBehavior" placeholder="Ex: Je scroll sur mon tÃ©lÃ©phone pendant 2h au lieu d'Ã©tudier..."></textarea>
                    </div>
                    
                    <div class="step">
                        <span class="step-number">3</span>
                        <strong>ConsÃ©quences immÃ©diates (APRÃˆS)</strong>
                        <p style="font-size: 0.9rem; color: #666; margin: 5px 0;">Qu'est-ce que ce comportement t'apporte immÃ©diatement ? (mÃªme si c'est nÃ©gatif Ã  long terme)</p>
                        <textarea id="problemAfter" placeholder="Ex: Je me sens moins stressÃ©, je suis distrait de mon anxiÃ©tÃ©, j'Ã©vite la difficultÃ©..."></textarea>
                    </div>
                    
                    <div class="step">
                        <span class="step-number">4</span>
                        <strong>Fonction du comportement</strong>
                        <p style="font-size: 0.9rem; color: #666; margin: 5px 0;">Quel besoin satisfait ce comportement ?</p>
                        <select id="problemFunction">
                            <option value="">-- Choisis la fonction principale --</option>
                            <option value="escape">Ã‰viter/Ã‰chapper (stress, ennui, difficultÃ©, Ã©motions nÃ©gatives)</option>
                            <option value="attention">Obtenir de l'attention (mÃªme nÃ©gative)</option>
                            <option value="tangible">Obtenir quelque chose de concret (objet, activitÃ© plaisante, stimulation)</option>
                            <option value="sensory">Stimulation sensorielle (besoin de bouger, de stimulation)</option>
                        </select>
                    </div>
                    
                    <div class="step">
                        <span class="step-number">5</span>
                        <strong>Comportement alternatif</strong>
                        <p style="font-size: 0.9rem; color: #666; margin: 5px 0;">Quel comportement pourrait satisfaire le MÃŠME besoin de faÃ§on plus adaptÃ©e ?</p>
                        <textarea id="problemAlternative" placeholder="Ex: Si je cherche Ã  Ã©viter le stress -> je peux faire 5 min de respiration avant d'Ã©tudier, dÃ©couper la tÃ¢che en 10 min..."></textarea>
                    </div>
                    
                    <div class="step">
                        <span class="step-number">6</span>
                        <strong>PremiÃ¨re action concrÃ¨te</strong>
                        <p style="font-size: 0.9rem; color: #666; margin: 5px 0;">La TOUTE premiÃ¨re micro-action pour mettre en place l'alternative</p>
                        <input type="text" id="problemFirstStep" placeholder="Ex: Mettre mon tÃ©lÃ©phone dans une autre piÃ¨ce avant de commencer" />
                    </div>
                    
                    <button onclick="solveProblem()">Analyser et crÃ©er mon plan</button>
                </div>
                <div id="problemResult"></div>
            </div>
        </div>

        <!-- FOCUS TIMER -->
        <div id="focus" class="tab-content">
            <div class="card">
                <h2 class="card-title"><span class="emoji">â±ï¸</span>Pomodoro Focus Timer</h2>
                <p style="text-align: center; margin-bottom: 20px;">Travaille par sessions courtes pour maintenir ta concentration</p>
                <div class="timer-display" id="timerDisplay">25:00</div>
                <div class="timer-controls">
                    <button onclick="startTimer()">â–¶ï¸ DÃ©marrer</button>
                    <button onclick="pauseTimer()">â¸ï¸ Pause</button>
                    <button onclick="resetTimer()">ğŸ”„ Reset</button>
                </div>
                <div style="margin-top: 20px; text-align: center;">
                    <select id="timerDuration" onchange="changeTimerDuration()">
                        <option value="15">15 minutes</option>
                        <option value="25" selected>25 minutes (Pomodoro)</option>
                        <option value="45">45 minutes</option>
                    </select>
                </div>
            </div>

            <div class="card">
                <h2 class="card-title"><span class="emoji">âš¡</span>Mon niveau d'Ã©nergie</h2>
                <p style="text-align: center;">Adapte tes tÃ¢ches Ã  ton Ã©nergie du moment</p>
                <div class="emotion-grid">
                    <div class="emotion-card" onclick="suggestByEnergy('high')">
                        <div class="emotion-icon">ğŸš€</div>
                        <div>Haute Ã©nergie</div>
                    </div>
                    <div class="emotion-card" onclick="suggestByEnergy('medium')">
                        <div class="emotion-icon">âš¡</div>
                        <div>Ã‰nergie moyenne</div>
                    </div>
                    <div class="emotion-card" onclick="suggestByEnergy('low')">
                        <div class="emotion-icon">ğŸ”‹</div>
                        <div>Basse Ã©nergie</div>
                    </div>
                </div>
                <div id="energySuggestions"></div>
            </div>
        </div>

        <!-- SITUATIONS DU QUOTIDIEN -->
        <div id="situations" class="tab-content">
            <div class="card">
                <h2 class="card-title"><span class="emoji">ğŸª</span>Recommandations par situation</h2>
                <p style="margin-bottom: 20px;">SÃ©lectionne la situation que tu vis en ce moment et dÃ©couvre des stratÃ©gies adaptÃ©es :</p>
                
                <div class="emotion-grid">
                    <div class="emotion-card" onclick="showSituation('procrastination')">
                        <div class="emotion-icon">â°</div>
                        <div>Procrastination</div>
                    </div>
                    <div class="emotion-card" onclick="showSituation('submergÃ©')">
                        <div class="emotion-icon">ğŸŒŠ</div>
                        <div>Je suis submergÃ©</div>
                    </div>
                    <div class="emotion-card" onclick="showSituation('distraction')">
                        <div class="emotion-icon">ğŸ¯</div>
                        <div>Impossible de me concentrer</div>
                    </div>
                    <div class="emotion-card" onclick="showSituation('hyperfocus')">
                        <div class="emotion-icon">ğŸ”¥</div>
                        <div>Hyperfocus</div>
                    </div>
                    <div class="emotion-card" onclick="showSituation('transitions')">
                        <div class="emotion-icon">ğŸ”„</div>
                        <div>DifficultÃ©s de transition</div>
                    </div>
                    <div class="emotion-card" onclick="showSituation('matin')">
                        <div class="emotion-icon">ğŸŒ…</div>
                        <div>DÃ©marrage difficile</div>
                    </div>
                    <div class="emotion-card" onclick="showSituation('soir')">
                        <div class="emotion-icon">ğŸŒ™</div>
                        <div>Coucher difficile</div>
                    </div>
                    <div class="emotion-card" onclick="showSituation('social')">
                        <div class="emotion-icon">ğŸ‘¥</div>
                        <div>Situations sociales</div>
                    </div>
                    <div class="emotion-card" onclick="showSituation('decisions')">
                        <div class="emotion-icon">ğŸ¤”</div>
                        <div>Paralysie dÃ©cisionnelle</div>
                    </div>
                    <div class="emotion-card" onclick="showSituation('rejection')">
                        <div class="emotion-icon">ğŸ’”</div>
                        <div>SensibilitÃ© au rejet</div>
                    </div>
                    <div class="emotion-card" onclick="showSituation('impulsivitÃ©')">
                        <div class="emotion-icon">âš¡</div>
                        <div>ImpulsivitÃ©</div>
                    </div>
                    <div class="emotion-card" onclick="showSituation('ennui')">
                        <div class="emotion-icon">ğŸ˜‘</div>
                        <div>Ennui intense</div>
                    </div>
                </div>
                
                <div id="situationResult"></div>
            </div>
        </div>

        <!-- ASTUCES -->
        <div id="tips" class="tab-content">
            <div class="tips-container">
                <div class="tip-card">
                    <div class="tip-icon">ğŸ“–</div>
                    <h3>Police adaptÃ©e (Dyslexie)</h3>
                    <p>Utilise des polices sans empattement comme Arial, Verdana ou OpenDyslexic. Augmente la taille (14pt minimum) et l'espacement entre les lignes.</p>
                </div>
                <div class="tip-card">
                    <div class="tip-icon">ğŸ¨</div>
                    <h3>Couleurs et surlignage</h3>
                    <p>Surligne les informations importantes en couleur. Utilise des fonds colorÃ©s lÃ©gers (beige, vert pÃ¢le) pour rÃ©duire la fatigue visuelle.</p>
                </div>
                <div class="tip-card">
                    <div class="tip-icon">ğŸ§</div>
                    <h3>Lecture audio</h3>
                    <p>Utilise des outils de synthÃ¨se vocale pour lire les textes Ã  haute voix. Ã‰couter aide souvent plus que lire.</p>
                </div>
                <div class="tip-card">
                    <div class="tip-icon">âœï¸</div>
                    <h3>Ã‰criture alternative</h3>
                    <p>PrivilÃ©gie le clavier Ã  l'Ã©criture manuscrite si c'est plus facile. Utilise des correcteurs orthographiques et des prÃ©dicteurs de mots.</p>
                </div>
                <div class="tip-card">
                    <div class="tip-icon">ğŸ—£ï¸</div>
                    <h3>Parle Ã  voix haute</h3>
                    <p>Verbalise tes pensÃ©es, rÃ©pÃ¨te les consignes oralement. Ã‡a aide Ã  mieux mÃ©moriser et comprendre.</p>
                </div>
                <div class="tip-card">
                    <div class="tip-icon">ğŸ“</div>
                    <h3>Supports visuels (Dyspraxie)</h3>
                    <p>Utilise des schÃ©mas, cartes mentales, pictogrammes. Les images aident Ã  compenser les difficultÃ©s de planification.</p>
                </div>
                <div class="tip-card">
                    <div class="tip-icon">ğŸ¯</div>
                    <h3>DÃ©coupage des tÃ¢ches</h3>
                    <p>Divise chaque activitÃ© en petites Ã©tapes claires et numÃ©rotÃ©es. Une Ã©tape = une action simple.</p>
                </div>
                <div class="tip-card">
                    <div class="tip-icon">ğŸ”¢</div>
                    <h3>Manipuler pour compter (Dyscalculie)</h3>
                    <p>Utilise des objets concrets (cubes, jetons, doigts) pour visualiser les quantitÃ©s et les opÃ©rations mathÃ©matiques.</p>
                </div>
                <div class="tip-card">
                    <div class="tip-icon">ğŸ“±</div>
                    <h3>Outils numÃ©riques</h3>
                    <p>Calculatrice, tableur, applications de conversion... Les outils tech sont tes alliÃ©s, utilise-les sans culpabilitÃ© !</p>
                </div>
                <div class="tip-card">
                    <div class="tip-icon">â°</div>
                    <h3>Temps Ã©tendu</h3>
                    <p>Demande plus de temps pour les tÃ¢ches et examens. C'est un amÃ©nagement lÃ©gitime, pas de la triche.</p>
                </div>
                <div class="tip-card">
                    <div class="tip-icon">ğŸ¤</div>
                    <h3>Expression orale privilÃ©giÃ©e</h3>
                    <p>Quand c'est possible, rÃ©ponds oralement plutÃ´t qu'Ã  l'Ã©crit. Tu peux utiliser l'enregistrement audio.</p>
                </div>
                <div class="tip-card">
                    <div class="tip-icon">ğŸ§ </div>
                    <h3>Multisensoriel</h3>
                    <p>Combine vue, ouÃ¯e, toucher et mouvement pour apprendre. Plus tu utilises de sens, mieux tu mÃ©morises !</p>
                </div>
                <div class="tip-card">
                    <div class="tip-icon">ğŸ“</div>
                    <h3>Consignes simplifiÃ©es</h3>
                    <p>Reformule les consignes avec tes propres mots. DÃ©coupe les phrases longues en plusieurs courtes.</p>
                </div>
                <div class="tip-card">
                    <div class="tip-icon">ğŸ®</div>
                    <h3>Gamification</h3>
                    <p>Transforme l'apprentissage en jeu. Les applications ludiques rendent l'entraÃ®nement plus motivant !</p>
                </div>
                <div class="tip-card">
                    <div class="tip-icon">ğŸ’ª</div>
                    <h3>Tes forces d'abord</h3>
                    <p>Concentre-toi sur ce que tu fais bien. Les troubles Dys ne dÃ©finissent pas ton intelligence ni tes capacitÃ©s !</p>
                </div>
                <div class="tip-card">
                    <div class="tip-icon">ğŸ¤</div>
                    <h3>Demande de l'aide</h3>
                    <p>N'hÃ©site jamais Ã  demander des explications supplÃ©mentaires, des reformulations, ou des amÃ©nagements. C'est ton droit !</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // GESTION DES ONGLETS
        function switchTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById(tabName).classList.add('active');
            
            // Activer le bouton cliquÃ©
            const clickedButton = Array.from(document.querySelectorAll('.tab-btn')).find(btn => 
                btn.textContent.includes(tabName === 'tasks' ? 'TÃ¢ches' : 
                                        tabName === 'emotions' ? 'Ã‰motions' :
                                        tabName === 'stats' ? 'Statistiques' :
                                        tabName === 'problem' ? 'ProblÃ¨me' :
                                        tabName === 'focus' ? 'Focus Timer' :
                                        tabName === 'situations' ? 'Situations' : 'Astuces')
            );
            if (clickedButton) clickedButton.classList.add('active');
            
            // Charger les donnÃ©es pour cet onglet
            if (tabName === 'tasks') loadTasks();
            if (tabName === 'emotions') loadJournalEntries();
            if (tabName === 'stats') {
                updateStatsCharts();
                loadMilestones();
            }
        }

        // GESTION DES TÃ‚CHES
        let tasks = JSON.parse(localStorage.getItem('tasks')) || [];
        
        function addTask() {
            const taskInput = document.getElementById('taskInput');
            const priority = document.getElementById('prioritySelect').value;
            
            if (taskInput.value.trim() === '') {
                alert('Entre une tÃ¢che !');
                return;
            }
            
            const task = {
                id: Date.now(),
                text: taskInput.value,
                priority: priority,
                completed: false,
                date: new Date().toLocaleDateString('fr-FR')
            };
            
            tasks.push(task);
            localStorage.setItem('tasks', JSON.stringify(tasks));
            taskInput.value = '';
            loadTasks();
        }
        
        function loadTasks() {
            const taskList = document.getElementById('taskList');
            taskList.innerHTML = '';
            
            if (tasks.length === 0) {
                taskList.innerHTML = '<p style="text-align: center; color: #999;">Aucune tÃ¢che pour le moment. Ajoute-en une ! ğŸ¯</p>';
                return;
            }
            
            // Trier par prioritÃ©
            const priorityOrder = { urgent: 0, important: 1, normal: 2, later: 3 };
            tasks.sort((a, b) => priorityOrder[a.priority] - priorityOrder[b.priority]);
            
            tasks.forEach(task => {
                const taskItem = document.createElement('div');
                taskItem.className = `task-item ${task.completed ? 'completed' : ''}`;
                taskItem.innerHTML = `
                    <input type="checkbox" class="task-checkbox" ${task.completed ? 'checked' : ''} 
                           onchange="toggleTask(${task.id})">
                    <div class="task-content">
                        <strong>${task.text}</strong>
                        <div style="font-size: 0.9rem; color: #666; margin-top: 5px;">${task.date}</div>
                    </div>
                    <span class="task-priority priority-${task.priority}">
                        ${task.priority === 'urgent' ? 'ğŸ”´ Urgent' : 
                          task.priority === 'important' ? 'ğŸŸ¡ Important' : 
                          task.priority === 'normal' ? 'ğŸŸ¢ Normal' : 'ğŸ”µ Plus tard'}
                    </span>
                    <button class="delete-btn" onclick="deleteTask(${task.id})">ğŸ—‘ï¸</button>
                `;
                taskList.appendChild(taskItem);
            });
            
            updateProgress();
        }
        
        function toggleTask(id) {
            const task = tasks.find(t => t.id === id);
            task.completed = !task.completed;
            localStorage.setItem('tasks', JSON.stringify(tasks));
            loadTasks();
        }
        
        function deleteTask(id) {
            tasks = tasks.filter(t => t.id !== id);
            localStorage.setItem('tasks', JSON.stringify(tasks));
            loadTasks();
        }
        
        function updateProgress() {
            const completed = tasks.filter(t => t.completed).length;
            const total = tasks.length;
            const percentage = total > 0 ? (completed / total) * 100 : 0;
            
            document.getElementById('completedCount').textContent = completed;
            document.getElementById('progressBar').style.width = percentage + '%';
        }

        // GESTION DES Ã‰MOTIONS
        let selectedEmotion = '';
        
        function selectEmotion(emotion, element) {
            selectedEmotion = emotion;
            document.querySelectorAll('.emotion-card').forEach(card => {
                card.classList.remove('selected');
            });
            element.classList.add('selected');
            
            const emotionData = {
                joyeux: {
                    suggestion: 'Super ! Profite de cette Ã©nergie positive pour attaquer des tÃ¢ches que tu repoussais. C\'est le moment idÃ©al ! ğŸŒŸ',
                    besoins: [
                        'âœ¨ Besoin de partager ta joie',
                        'ğŸ¯ Besoin d\'utiliser cette Ã©nergie de faÃ§on productive',
                        'ğŸ‰ Besoin de cÃ©lÃ©brer tes rÃ©ussites',
                        'ğŸŒ± Besoin de cultiver ce moment positif'
                    ],
                    actions: [
                        'Lance-toi dans un projet qui te motive',
                        'Partage ta joie avec quelqu\'un',
                        'Note ce qui t\'a rendu joyeux (pour y revenir plus tard)',
                        'Utilise cette Ã©nergie pour les tÃ¢ches difficiles'
                    ]
                },
                calme: {
                    suggestion: 'Excellent Ã©tat pour rÃ©flÃ©chir et planifier. Prends le temps d\'organiser ta journÃ©e ou de faire des tÃ¢ches qui demandent de la concentration. ğŸ§˜',
                    besoins: [
                        'ğŸ§˜ Besoin de prÃ©server ce calme intÃ©rieur',
                        'ğŸ¯ Besoin de clartÃ© mentale',
                        'ğŸ“‹ Besoin d\'organiser tes pensÃ©es',
                        'ğŸŒ¿ Besoin de tÃ¢ches qui demandent de la rÃ©flexion'
                    ],
                    actions: [
                        'Fais ta planification de la semaine',
                        'Attaque les tÃ¢ches qui demandent de la concentration',
                        'MÃ©dite ou fais des exercices de respiration',
                        'Ã‰cris dans ton journal pour clarifier tes idÃ©es'
                    ]
                },
                anxieux: {
                    suggestion: 'Respire profondÃ©ment. Fais une pause, sors marcher 5 minutes, ou fais une activitÃ© qui t\'apaise. L\'anxiÃ©tÃ© passera. ğŸŒ¬ï¸',
                    besoins: [
                        'ğŸ›¡ï¸ Besoin de sÃ©curitÃ© et de rÃ©assurance',
                        'ğŸŒ¬ï¸ Besoin de calmer ton systÃ¨me nerveux',
                        'ğŸ¯ Besoin de reprendre le contrÃ´le',
                        'ğŸ’ª Besoin de te sentir capable'
                    ],
                    actions: [
                        'Respiration 4-7-8 (inspire 4s, retiens 7s, expire 8s)',
                        'Nomme 5 choses que tu vois, 4 que tu touches, 3 que tu entends',
                        'Ã‰cris ce qui t\'angoisse pour le sortir de ta tÃªte',
                        'Fais une micro-tÃ¢che facile pour retrouver un sentiment de contrÃ´le'
                    ]
                },
                frustrÃ©: {
                    suggestion: 'C\'est ok d\'Ãªtre frustrÃ©. Prends une pause active : bouge, Ã©coute de la musique Ã©nergique, ou Ã©vacue en Ã©crivant ce qui te frustre. ğŸ’ª',
                    besoins: [
                        'ğŸ’¨ Besoin d\'Ã©vacuer cette Ã©nergie bloquÃ©e',
                        'ğŸ¯ Besoin de rÃ©soudre ce qui bloque',
                        'ğŸ‘‚ Besoin d\'Ãªtre entendu et compris',
                        'ğŸ’ª Besoin de retrouver ton pouvoir d\'action'
                    ],
                    actions: [
                        'Fais 10 squats ou sors marcher rapidement',
                        'Ã‰cris rageusement ce qui te frustre (puis dÃ©chire la feuille)',
                        'Mets de la musique Ã©nergique et danse',
                        'Identifie UNE chose concrÃ¨te que tu peux changer'
                    ]
                },
                triste: {
                    suggestion: 'Sois doux avec toi-mÃªme. Fais des choses simples et rÃ©confortantes. Pas besoin d\'Ãªtre productif aujourd\'hui si ce n\'est pas le bon moment. ğŸŒˆ',
                    besoins: [
                        'ğŸ¤— Besoin de rÃ©confort et de douceur',
                        'ğŸ˜¢ Besoin d\'exprimer ta tristesse',
                        'ğŸ«‚ Besoin de connexion humaine',
                        'ğŸ›Œ Besoin de prendre soin de toi'
                    ],
                    actions: [
                        'Appelle ou Ã©cris Ã  quelqu\'un de confiance',
                        'Fais quelque chose de rÃ©confortant (couverture, thÃ©, musique douce)',
                        'Autorise-toi Ã  pleurer si tu en as besoin',
                        'Ne force rien aujourd\'hui, repose-toi'
                    ]
                },
                dÃ©bordÃ©: {
                    suggestion: 'Stop ! Fais une liste de TOUT ce qui te stresse. Puis choisis UNE SEULE mini-tÃ¢che Ã  faire maintenant. Le reste peut attendre. ğŸ›‘',
                    besoins: [
                        'ğŸ›‘ Besoin d\'arrÃªter et de faire une pause',
                        'ğŸ“ Besoin d\'organiser le chaos mental',
                        'ğŸ¯ Besoin de simplifier et prioriser',
                        'ğŸ’ª Besoin de retrouver un sentiment de contrÃ´le'
                    ],
                    actions: [
                        'Brain dump : Ã©cris TOUT sur papier pendant 5 min',
                        'Respire 10 fois profondÃ©ment',
                        'Choisis UNE SEULE tÃ¢che mini Ã  faire maintenant',
                        'Dis NON ou demande de l\'aide pour le reste'
                    ]
                },
                excitÃ©: {
                    suggestion: 'Canalise cette Ã©nergie ! C\'est parfait pour faire avancer des projets crÃ©atifs ou des tÃ¢ches dynamiques. Attention Ã  ne pas te disperser ! âš¡',
                    besoins: [
                        'âš¡ Besoin de canaliser cette Ã©nergie',
                        'ğŸ¨ Besoin de crÃ©er et d\'explorer',
                        'ğŸ¯ Besoin de focus pour ne pas te disperser',
                        'ğŸš€ Besoin d\'action et de mouvement'
                    ],
                    actions: [
                        'Choisis UN projet et mets un timer de 25 min',
                        'Fais une liste rapide pour capturer toutes tes idÃ©es',
                        'Lance-toi dans quelque chose de crÃ©atif',
                        'Bouge ton corps : danse, marche rapide, sport'
                    ]
                },
                fatiguÃ©: {
                    suggestion: 'Ton corps te parle. Soit tu te reposes, soit tu fais des mini-tÃ¢ches faciles. Ne force pas. Le repos n\'est pas de la paresse. ğŸ˜´',
                    besoins: [
                        'ğŸ˜´ Besoin de repos et de rÃ©cupÃ©ration',
                        'ğŸ”‹ Besoin de recharger ton Ã©nergie',
                        'ğŸ’¤ Besoin de respecter tes limites',
                        'ğŸŒ™ Besoin de sommeil de qualitÃ©'
                    ],
                    actions: [
                        'Fais une micro-sieste de 20 min si possible',
                        'Hydrate-toi et mange quelque chose de nourrissant',
                        'Ne fais que des tÃ¢ches automatiques et faciles',
                        'Planifie un vrai temps de repos ce soir'
                    ]
                }
            };
            
            const data = emotionData[emotion];
            
            const resultDiv = document.getElementById('emotionResult');
            resultDiv.innerHTML = `
                <div class="result-box">
                    <h3>ğŸ’¡ Suggestion personnalisÃ©e</h3>
                    <p style="font-size: 1.1rem; margin-bottom: 20px;">${data.suggestion}</p>
                    
                    <div style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); padding: 20px; border-radius: 10px; margin: 15px 0;">
                        <h4 style="margin-bottom: 15px;">ğŸ¯ Besoins identifiÃ©s :</h4>
                        <ul style="list-style: none; padding: 0;">
                            ${data.besoins.map(besoin => `
                                <li style="margin: 8px 0; padding: 8px; background: rgba(255,255,255,0.6); border-radius: 5px;">
                                    ${besoin}
                                </li>
                            `).join('')}
                        </ul>
                    </div>
                    
                    <div style="background: white; padding: 20px; border-radius: 10px; border: 2px solid var(--secondary);">
                        <h4 style="color: var(--secondary); margin-bottom: 15px;">âœ… Actions recommandÃ©es :</h4>
                        <ul style="margin-left: 20px;">
                            ${data.actions.map(action => `<li style="margin: 8px 0;">${action}</li>`).join('')}
                        </ul>
                    </div>
                </div>
            `;
        }
        
        function saveEmotionEntry() {
            const journal = document.getElementById('emotionJournal').value;
            if (!selectedEmotion || journal.trim() === '') {
                alert('SÃ©lectionne une Ã©motion et Ã©cris quelque chose !');
                return;
            }
            
            const entries = JSON.parse(localStorage.getItem('emotionEntries')) || [];
            const entry = {
                emotion: selectedEmotion,
                text: journal,
                date: new Date().toLocaleString('fr-FR'),
                timestamp: Date.now()
            };
            entries.unshift(entry);
            
            localStorage.setItem('emotionEntries', JSON.stringify(entries.slice(0, 50)));
            
            // Aussi sauvegarder pour les stats
            const emotionStats = JSON.parse(localStorage.getItem('emotionStats')) || [];
            emotionStats.push({
                emotion: selectedEmotion,
                timestamp: Date.now(),
                date: new Date().toISOString()
            });
            localStorage.setItem('emotionStats', JSON.stringify(emotionStats));
            
            document.getElementById('emotionJournal').value = '';
            loadJournalEntries();
            
            alert('âœ… Ton ressenti est enregistrÃ© !');
        }
        
        function loadJournalEntries() {
            const entries = JSON.parse(localStorage.getItem('emotionEntries')) || [];
            const container = document.getElementById('journalEntries');
            
            if (entries.length === 0) return;
            
            container.innerHTML = '<h3 style="margin-top: 30px;">ğŸ“š Mes derniÃ¨res entrÃ©es</h3>';
            entries.forEach(entry => {
                const entryDiv = document.createElement('div');
                entryDiv.className = 'result-box';
                entryDiv.style.marginTop = '15px';
                entryDiv.innerHTML = `
                    <strong>${entry.emotion.charAt(0).toUpperCase() + entry.emotion.slice(1)} - ${entry.date}</strong>
                    <p style="margin-top: 10px;">${entry.text}</p>
                `;
                container.appendChild(entryDiv);
            });
        }

        // RÃ‰SOLUTION DE PROBLÃˆME
        function solveProblem() {
            const before = document.getElementById('problemBefore').value;
            const behavior = document.getElementById('problemBehavior').value;
            const after = document.getElementById('problemAfter').value;
            const functionSelect = document.getElementById('problemFunction').value;
            const alternative = document.getElementById('problemAlternative').value;
            const firstStep = document.getElementById('problemFirstStep').value;
            
            if (!before || !behavior || !after || !functionSelect || !alternative || !firstStep) {
                alert('Remplis tous les champs pour faire ton analyse fonctionnelle !');
                return;
            }
            
            const functions = {
                escape: {
                    name: 'Ã‰viter/Ã‰chapper',
                    icon: 'ğŸƒ',
                    explanation: 'Ton comportement sert Ã  Ã©viter quelque chose de dÃ©sagrÃ©able (stress, ennui, difficultÃ©). C\'est une stratÃ©gie d\'Ã©vitement.',
                    tips: [
                        'Identifie ce que tu Ã©vites exactement (l\'Ã©motion ? la difficultÃ© ? l\'Ã©chec potentiel ?)',
                        'Trouve des moyens plus adaptatÃ©s de gÃ©rer ce que tu Ã©vites',
                        'DÃ©coupe la tÃ¢che Ã©vitÃ©e en micro-Ã©tapes moins menaÃ§antes',
                        'Utilise des techniques de rÃ©gulation Ã©motionnelle avant de commencer'
                    ]
                },
                attention: {
                    name: 'Obtenir de l\'attention',
                    icon: 'ğŸ‘‹',
                    explanation: 'Ton comportement attire l\'attention des autres, mÃªme si c\'est nÃ©gatif. Tu as besoin d\'Ãªtre vu et reconnu.',
                    tips: [
                        'Trouve des moyens positifs d\'obtenir de l\'attention',
                        'Communique directement ton besoin d\'Ãªtre Ã©coutÃ©',
                        'Planifie des moments de qualitÃ© avec les autres',
                        'Demande explicitement ce dont tu as besoin'
                    ]
                },
                tangible: {
                    name: 'Obtenir quelque chose',
                    icon: 'ğŸ',
                    explanation: 'Ton comportement te permet d\'obtenir quelque chose que tu veux (activitÃ© plaisante, stimulation, dopamine).',
                    tips: [
                        'Utilise un systÃ¨me de rÃ©compenses structurÃ©',
                        'Planifie les activitÃ©s plaisantes APRÃˆS les tÃ¢ches',
                        'Trouve des alternatives qui te donnent satisfaction sans procrastiner',
                        'CrÃ©e un Ã©quilibre entre effort et rÃ©compense'
                    ]
                },
                sensory: {
                    name: 'Stimulation sensorielle',
                    icon: 'âš¡',
                    explanation: 'Ton comportement rÃ©pond Ã  un besoin de stimulation sensorielle. Ton cerveau TDAH a besoin de bouger, toucher, stimuler.',
                    tips: [
                        'IntÃ¨gre du mouvement dans ton travail (ballon, bureau debout, marche)',
                        'Utilise des fidgets pendant les tÃ¢ches',
                        'PrÃ©vois des pauses actives toutes les 25 minutes',
                        'Accepte que ton corps a besoin de bouger pour te concentrer'
                    ]
                }
            };
            
            const selectedFunction = functions[functionSelect];
            
            const resultDiv = document.getElementById('problemResult');
            resultDiv.innerHTML = `
                <div class="result-box">
                    <h3>ğŸ“Š Ton analyse fonctionnelle</h3>
                    
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; margin: 15px 0;">
                        <p><strong>ğŸ” Situation :</strong> ${before}</p>
                        <p style="margin-top: 10px;"><strong>âš ï¸ Comportement :</strong> ${behavior}</p>
                        <p style="margin-top: 10px;"><strong>â¡ï¸ ConsÃ©quence :</strong> ${after}</p>
                    </div>
                    
                    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 20px; border-radius: 10px; color: white; margin: 15px 0;">
                        <h4 style="margin-bottom: 10px;">${selectedFunction.icon} Fonction identifiÃ©e : ${selectedFunction.name}</h4>
                        <p>${selectedFunction.explanation}</p>
                    </div>
                    
                    <div style="background: white; padding: 15px; border-radius: 10px; margin: 15px 0; border: 2px solid var(--secondary);">
                        <h4 style="color: var(--secondary); margin-bottom: 10px;">ğŸ’¡ StratÃ©gies recommandÃ©es :</h4>
                        <ul style="margin-left: 20px;">
                            ${selectedFunction.tips.map(tip => `<li style="margin: 8px 0;">${tip}</li>`).join('')}
                        </ul>
                    </div>
                    
                    <div style="background: #e8f5e9; padding: 15px; border-radius: 10px; margin: 15px 0;">
                        <h4 style="color: var(--success); margin-bottom: 10px;">âœ… Comportement alternatif :</h4>
                        <p style="font-size: 1.1rem;">${alternative}</p>
                    </div>
                    
                    <div style="background: linear-gradient(135deg, var(--accent) 0%, var(--warning) 100%); padding: 20px; border-radius: 10px; color: var(--dark); margin-top: 15px;">
                        <h4 style="margin-bottom: 10px;">ğŸš€ PREMIÃˆRE ACTION MAINTENANT :</h4>
                        <p style="font-size: 1.2rem; font-weight: 600;">${firstStep}</p>
                    </div>
                    
                    <p style="margin-top: 15px; font-style: italic; color: #666;">
                        ğŸ’¡ Astuce : Le changement prend du temps. Observe les dÃ©clencheurs (AVANT), teste ton alternative progressivement, 
                        et ajuste jusqu'Ã  trouver ce qui marche POUR TOI. Sois patient et bienveillant avec toi-mÃªme.
                    </p>
                </div>
            `;
            
            // Ajouter automatiquement comme tÃ¢che urgente
            const task = {
                id: Date.now(),
                text: firstStep,
                priority: 'urgent',
                completed: false,
                date: new Date().toLocaleDateString('fr-FR')
            };
            tasks.push(task);
            localStorage.setItem('tasks', JSON.stringify(tasks));
            
            // Scroll vers le rÃ©sultat
            resultDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // TIMER POMODORO
        let timerInterval;
        let timeLeft = 1500; // 25 minutes en secondes
        let isRunning = false;
        
        function startTimer() {
            if (isRunning) return;
            isRunning = true;
            
            timerInterval = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();
                
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    isRunning = false;
                    alert('ğŸ‰ Bravo ! Session terminÃ©e ! Prends une pause de 5 minutes.');
                    playSound();
                }
            }, 1000);
        }
        
        function pauseTimer() {
            clearInterval(timerInterval);
            isRunning = false;
        }
        
        function resetTimer() {
            clearInterval(timerInterval);
            isRunning = false;
            const duration = document.getElementById('timerDuration').value;
            timeLeft = duration * 60;
            updateTimerDisplay();
        }
        
        function changeTimerDuration() {
            resetTimer();
        }
        
        function updateTimerDisplay() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            document.getElementById('timerDisplay').textContent = 
                `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }
        
        function playSound() {
            // Simple beep avec Web Audio API
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            oscillator.type = 'sine';
            oscillator.frequency.value = 800;
            oscillator.connect(audioContext.destination);
            oscillator.start();
            oscillator.stop(audioContext.currentTime + 0.3);
        }

        // RECOMMANDATIONS SITUATIONNELLES
        function showSituation(situationType) {
            const situations = {
                procrastination: {
                    title: 'â° Procrastination - Briser le cercle',
                    strategies: [
                        '<strong>La rÃ¨gle des 2 minutes :</strong> Commence juste 2 minutes. Une fois lancÃ©, c\'est plus facile de continuer.',
                        '<strong>DÃ©coupe ultra-fin :</strong> Si la tÃ¢che semble Ã©norme, dÃ©coupe-la en Ã©tapes de 5 minutes max.',
                        '<strong>Change de lieu :</strong> Va dans une autre piÃ¨ce, un cafÃ©, dehors. Parfois le lieu bloque.',
                        '<strong>RÃ©compense immÃ©diate :</strong> Promets-toi quelque chose de plaisant JUSTE APRÃˆS (pas aprÃ¨s tout, aprÃ¨s la premiÃ¨re Ã©tape).',
                        '<strong>Timer inversÃ© :</strong> "Je travaille jusqu\'Ã  15h37" plutÃ´t que "pendant 30 minutes" (bizarrement Ã§a marche mieux).',
                        '<strong>Body double :</strong> Travaille Ã  cÃ´tÃ© de quelqu\'un, mÃªme en silence, mÃªme en visio.'
                    ],
                    immediate: 'Choisis LA PLUS PETITE action possible et lance-toi maintenant, mÃªme si c\'est juste ouvrir le fichier.'
                },
                submergÃ©: {
                    title: 'ğŸŒŠ SubmergÃ© - Retrouver la surface',
                    strategies: [
                        '<strong>Brain dump total :</strong> Ã‰cris TOUT ce qui te stresse sur papier, sans ordre, pendant 5 minutes.',
                        '<strong>CatÃ©gorise aprÃ¨s :</strong> Une fois tout sorti, regroupe par thÃ¨mes (urgent/important/peut attendre/peut dÃ©lÃ©guer).',
                        '<strong>La rÃ¨gle du 1 :</strong> Choisis UNE SEULE mini-tÃ¢che. Le reste n\'existe pas pour les 15 prochaines minutes.',
                        '<strong>Respiration 4-7-8 :</strong> Inspire 4s, retiens 7s, expire 8s. RÃ©pÃ¨te 4 fois. Ã‡a calme le systÃ¨me nerveux.',
                        '<strong>Accepte l\'imperfection :</strong> Fait > Parfait. Toujours.',
                        '<strong>Demande de l\'aide :</strong> DÃ©lÃ©guer n\'est pas Ã©chouer, c\'est Ãªtre intelligent.'
                    ],
                    immediate: 'ArrÃªte tout. Respire. Fais une liste. Choisis UN truc. Juste un.'
                },
                distraction: {
                    title: 'ğŸ¯ Concentration impossible - CrÃ©er une bulle',
                    strategies: [
                        '<strong>Mode avion total :</strong> TÃ©lÃ©phone en avion, notifications OFF partout, ferme TOUS les onglets sauf 1.',
                        '<strong>Musique spÃ©cifique :</strong> CrÃ©e UNE playlist "focus" et utilise toujours la mÃªme (ton cerveau va l\'associer au travail).',
                        '<strong>Timer courts :</strong> 15 minutes de focus, puis 5 minutes de distraction autorisÃ©e. Alterne.',
                        '<strong>Change de sens :</strong> Si tu ne peux pas lire, essaie d\'Ã©couter. Si tu ne peux pas Ã©crire, dicte Ã  voix haute.',
                        '<strong>Accepte le mouvement :</strong> Ballon d\'assise, fidget, marche en rÃ©flÃ©chissant. Bouge pendant que tu travailles.',
                        '<strong>Gamification :</strong> Transforme la tÃ¢che en jeu ou challenge avec timer.'
                    ],
                    immediate: 'Ã‰limine UNE distraction maintenant. Juste une. Puis focus 10 minutes.'
                },
                hyperfocus: {
                    title: 'ğŸ”¥ Hyperfocus - Canaliser la puissance',
                    strategies: [
                        '<strong>Profite mais protÃ¨ge :</strong> C\'est un super-pouvoir ! Mais mets des alarmes pour boire/manger/bouger.',
                        '<strong>Capture tes idÃ©es :</strong> Note tout ce qui te vient sans quitter ta tÃ¢che (doc Ã  cÃ´tÃ© ou vocal).',
                        '<strong>Timer de pause forcÃ©e :</strong> Toutes les 90 minutes MAX, lÃ¨ve-toi 5 minutes (mÃªme si tu ne veux pas).',
                        '<strong>PrÃ©pare l\'environnement :</strong> Avant de plonger : eau, snacks, toilettes, tÃ©lÃ©phone loin.',
                        '<strong>Choisis tes combats :</strong> Garde l\'hyperfocus pour les tÃ¢ches importantes, pas pour scroller.',
                        '<strong>PrÃ©viens ton entourage :</strong> Dis que tu seras indispo pendant X temps.'
                    ],
                    immediate: 'Mets un timer pour dans 60 minutes pour faire une pause. Vraiment.'
                },
                transitions: {
                    title: 'ğŸ”„ Transitions difficiles - Adoucir les changements',
                    strategies: [
                        '<strong>Timer de prÃ©venance :</strong> Mets une alarme 10 min AVANT de devoir changer d\'activitÃ©.',
                        '<strong>Rituel de transition :</strong> CrÃ©e une mini-routine (ex: 3 grandes respirations + ranger son espace).',
                        '<strong>PrÃ©pare le suivant :</strong> Avant de finir A, pose 1 Ã©lÃ©ment pour dÃ©marrer B (ouvre le doc, sors le matÃ©riel).',
                        '<strong>Accepte le temps mort :</strong> Autorise-toi 5 minutes de "rien" entre deux tÃ¢ches.',
                        '<strong>Musique pont :</strong> Une chanson spÃ©cifique pour marquer la transition.',
                        '<strong>Checklist visuelle :</strong> Coche visuellement "TÃ¢che A terminÃ©e" avant de passer Ã  B.'
                    ],
                    immediate: 'Termine ce que tu fais dans les 5 prochaines minutes, mÃªme imparfaitement, puis fais une pause vraie de 5 min.'
                },
                matin: {
                    title: 'ğŸŒ… DÃ©marrage difficile - Routine de lancement',
                    strategies: [
                        '<strong>PrÃ©pare la veille :</strong> VÃªtements sortis, petit-dÃ©j prÃ©parÃ©, sac prÃªt. Ton toi du matin te remerciera.',
                        '<strong>Alarme progressive :</strong> LumiÃ¨re douce qui augmente + sons de nature plutÃ´t qu\'alarme agressive.',
                        '<strong>Routine ultra-simple :</strong> 3-5 actions TOUJOURS dans le mÃªme ordre (cerveau en pilote auto).',
                        '<strong>Pas de dÃ©cisions le matin :</strong> Tout doit Ãªtre dÃ©cidÃ© la veille (habits, petit-dÃ©j, premiÃ¨re tÃ¢che).',
                        '<strong>LumiÃ¨re et mouvement :</strong> Ouvre fenÃªtre + 5 Ã©tirements = signal "jour" pour ton cerveau.',
                        '<strong>Pas de tÃ©lÃ©phone avant :</strong> Termine ta routine AVANT de regarder ton tel (sinon tu y passes 1h).'
                    ],
                    immediate: 'Ce soir, prÃ©pare TOUT pour demain matin. LittÃ©ralement tout.'
                },
                soir: {
                    title: 'ğŸŒ™ Coucher difficile - Rituel d\'atterrissage',
                    strategies: [
                        '<strong>Heure fixe non-nÃ©gociable :</strong> MÃªme heure de coucher 7j/7. Ton cerveau a besoin de routine.',
                        '<strong>Routine de "descente" :</strong> Commence 1h avant : lumiÃ¨res basses, activitÃ©s calmes, tempÃ©rature fraÃ®che.',
                        '<strong>Brain dump du soir :</strong> Vide toutes tes pensÃ©es/to-do de demain sur papier. LibÃ¨re ton cerveau.',
                        '<strong>ZÃ©ro Ã©cran 30 min avant :</strong> Vraiment. La lumiÃ¨re bleue dÃ©truit ton endormissement.',
                        '<strong>ActivitÃ© ennuyeuse :</strong> Lis quelque chose de chiant, Ã©coute un podcast monotone.',
                        '<strong>Accepte le temps :</strong> S\'endormir prend du temps, c\'est normal. Ne stresse pas.'
                    ],
                    immediate: 'Ã‰teins tous les Ã©crans MAINTENANT et fais ton brain dump sur papier.'
                },
                social: {
                    title: 'ğŸ‘¥ Situations sociales - Naviguer les interactions',
                    strategies: [
                        '<strong>PrÃ©pare des scripts :</strong> Phrases toutes faites pour small talk ("Et toi, Ã§a va ?", "IntÃ©ressant !").',
                        '<strong>Pauses stratÃ©giques :</strong> Va aux toilettes pour respirer et recharger en Ã©nergie sociale.',
                        '<strong>Limite temporelle :</strong> "Je peux rester jusqu\'Ã  20h" (Ã§a diminue l\'anxiÃ©tÃ©).',
                        '<strong>Trouve ton rÃ´le :</strong> Aide en cuisine, sers Ã  boire... Avoir une fonction aide Ã  gÃ©rer l\'interaction.',
                        '<strong>Ami ancre :</strong> Va avec quelqu\'un que tu connais bien qui te sÃ©curise.',
                        '<strong>AprÃ¨s-social :</strong> PrÃ©vois du temps seul aprÃ¨s pour te ressourcer.'
                    ],
                    immediate: 'Si c\'est trop : excuse-toi 5 min, va respirer dehors ou aux toilettes. Reviens si tu peux.'
                },
                decisions: {
                    title: 'ğŸ¤” Paralysie dÃ©cisionnelle - Sortir du blocage',
                    strategies: [
                        '<strong>Limite les options :</strong> Max 3 choix. Plus = paralysie.',
                        '<strong>Timer dÃ©cision :</strong> 5 minutes pour dÃ©cider, puis tu DOIS choisir.',
                        '<strong>Pile ou face :</strong> Lance une piÃ¨ce. Si tu es dÃ©Ã§u du rÃ©sultat, tu sais ce que tu veux vraiment.',
                        '<strong>Et si je me trompe ?</strong> La plupart des dÃ©cisions sont rÃ©versibles. Commence, ajuste ensuite.',
                        '<strong>DÃ©lÃ¨gue :</strong> Demande Ã  quelqu\'un de confiance de choisir pour toi.',
                        '<strong>CoÃ»t d\'opportunitÃ© :</strong> Ne pas dÃ©cider est aussi une dÃ©cision (souvent la pire).'
                    ],
                    immediate: 'Choisis maintenant. SÃ©rieusement. Lance un dÃ© si nÃ©cessaire. GO.'
                },
                rejection: {
                    title: 'ğŸ’” SensibilitÃ© au rejet - Adoucir la blessure',
                    strategies: [
                        '<strong>RSD est rÃ©el :</strong> Rejection Sensitive Dysphoria touche 99% des TDAH. Tu n\'es pas "trop sensible".',
                        '<strong>Pause avant rÃ©action :</strong> Attends 24h avant de rÃ©pondre quand tu te sens rejetÃ©.',
                        '<strong>Questionne l\'interprÃ©tation :</strong> "Est-ce vraiment un rejet ou je surinterprÃ¨te ?"',
                        '<strong>Parle-en :</strong> "J\'ai senti que... est-ce que j\'interprÃ¨te mal ?" (souvent tu interprÃ¨tes mal).',
                        '<strong>Liste des preuves d\'amour :</strong> Garde une note avec des messages gentils reÃ§us, Ã  relire en cas de RSD.',
                        '<strong>Auto-compassion :</strong> Parle-toi comme Ã  ton meilleur ami. Avec douceur.'
                    ],
                    immediate: 'Respire. C\'est probablement ton cerveau TDAH qui exagÃ¨re. Attends demain pour analyser.'
                },
                impulsivitÃ©: {
                    title: 'âš¡ ImpulsivitÃ© - CrÃ©er un espace de rÃ©flexion',
                    strategies: [
                        '<strong>RÃ¨gle des 24h :</strong> Achats/dÃ©cisions importantes = attendre 24h minimum.',
                        '<strong>Budget impulsivitÃ© :</strong> Autorise-toi Xâ‚¬/mois pour les achats impulsifs (limite les dÃ©gÃ¢ts).',
                        '<strong>Liste de souhaits :</strong> Note l\'envie au lieu d\'acheter. Revois la liste dans 1 semaine.',
                        '<strong>Pause physique :</strong> Avant d\'agir, fais 10 squats ou sors 2 minutes. Ã‡a calme l\'impulsion.',
                        '<strong>Appel d\'un ami :</strong> "Je veux faire X, parle-moi 5 minutes" (souvent l\'impulsion passe).',
                        '<strong>Canaux d\'Ã©nergie :</strong> Redirige l\'Ã©nergie vers du sport, de l\'art, quelque chose de productif.'
                    ],
                    immediate: 'Attends 10 minutes. Mets un timer. Si tu veux toujours aprÃ¨s, ok.'
                },
                ennui: {
                    title: 'ğŸ˜‘ Ennui intense - Nourrir le cerveau TDAH',
                    strategies: [
                        '<strong>Accepte-le :</strong> L\'ennui est PHYSIQUEMENT douloureux pour un cerveau TDAH. Ce n\'est pas de la faiblesse.',
                        '<strong>Stimulation douce :</strong> Fidget, musique, gomme Ã  mÃ¢cher pendant les tÃ¢ches ennuyeuses.',
                        '<strong>Gamifie :</strong> Transforme tout en jeu/challenge avec timer et rÃ©compenses.',
                        '<strong>Body double :</strong> Travailler "avec" quelqu\'un (mÃªme en silence) rend moins ennuyeux.',
                        '<strong>Alterne :</strong> 15 min tÃ¢che chiante, 5 min tÃ¢che fun. Alterne.',
                        '<strong>NouveautÃ© :</strong> Change de lieu, de mÃ©thode, d\'outil. La nouveautÃ© stimule le TDAH.'
                    ],
                    immediate: 'Mets de la musique, prends un fidget, et lance un timer de 15 minutes. Tu peux tout supporter 15 minutes.'
                }
            };
            
            const situationData = situations[situationType];
            const resultDiv = document.getElementById('situationResult');
            
            resultDiv.innerHTML = `
                <div class="result-box" style="margin-top: 30px;">
                    <h3 style="color: var(--primary); margin-bottom: 20px;">${situationData.title}</h3>
                    
                    <div style="background: white; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                        <h4 style="color: var(--secondary); margin-bottom: 15px;">ğŸ“‹ StratÃ©gies Ã  tester :</h4>
                        <ul style="list-style: none; padding: 0;">
                            ${situationData.strategies.map(strategy => `
                                <li style="margin: 15px 0; padding: 10px; background: #f8f9fa; border-radius: 8px;">
                                    ${strategy}
                                </li>
                            `).join('')}
                        </ul>
                    </div>
                    
                    <div style="background: linear-gradient(135deg, var(--accent) 0%, var(--warning) 100%); padding: 20px; border-radius: 10px; color: var(--dark);">
                        <h4 style="margin-bottom: 10px;">âš¡ ACTION IMMÃ‰DIATE :</h4>
                        <p style="font-size: 1.1rem; font-weight: 500;">${situationData.immediate}</p>
                    </div>
                </div>
            `;
            
            // Scroll vers le rÃ©sultat
            resultDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // SUGGESTIONS SELON L'Ã‰NERGIE
        function suggestByEnergy(level) {
            const suggestions = {
                high: {
                    title: 'ğŸš€ Haute Ã©nergie - Fonce !',
                    tasks: [
                        'TÃ¢ches complexes qui demandent de la rÃ©flexion',
                        'Apprentissage de nouvelles compÃ©tences',
                        'Projets crÃ©atifs ambitieux',
                        'TÃ¢ches physiques ou sportives',
                        'Conversations importantes ou difficiles',
                        'RÃ©solution de problÃ¨mes compliquÃ©s'
                    ]
                },
                medium: {
                    title: 'âš¡ Ã‰nergie moyenne - Ã‰quilibre',
                    tasks: [
                        'TÃ¢ches de routine bien Ã©tablies',
                        'RÃ©pondre aux emails',
                        'Organiser et planifier',
                        'TÃ¢ches mÃ©nagÃ¨res lÃ©gÃ¨res',
                        'Lecture ou apprentissage lÃ©ger',
                        'Appels tÃ©lÃ©phoniques standards'
                    ]
                },
                low: {
                    title: 'ğŸ”‹ Basse Ã©nergie - Douceur',
                    tasks: [
                        'TÃ¢ches automatiques et simples',
                        'Ranger/trier (sans pression)',
                        'Ã‰couter des podcasts ou vidÃ©os Ã©ducatives',
                        'Faire des listes pour plus tard',
                        'MÃ©ditation ou Ã©tirements doux',
                        'Te reposer SANS CULPABILITÃ‰ !'
                    ]
                }
            };
            
            const suggestion = suggestions[level];
            const resultDiv = document.getElementById('energySuggestions');
            
            resultDiv.innerHTML = `
                <div class="result-box">
                    <h3>${suggestion.title}</h3>
                    <p><strong>TÃ¢ches recommandÃ©es :</strong></p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        ${suggestion.tasks.map(task => `<li style="margin: 8px 0;">${task}</li>`).join('')}
                    </ul>
                </div>
            `;
        }

        // STATISTIQUES ET GRAPHIQUES
        let emotionsChart = null;
        let tasksChart = null;
        let currentPeriod = 'today';

        function changeStatsPeriod(period) {
            currentPeriod = period;
            
            // Mettre Ã  jour les boutons
            document.querySelectorAll('.period-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById('btn-' + period).classList.add('active');
            
            // Mettre Ã  jour le label
            const labels = {
                today: "aujourd'hui",
                week: "cette semaine",
                month: "ce mois"
            };
            document.getElementById('periodLabel').textContent = labels[period];
            
            // Mettre Ã  jour les graphiques
            updateStatsCharts();
        }

        function updateStatsCharts() {
            updateEmotionsChart();
            updateTasksChart();
            updateSummaryStats();
        }

        function getDateRange(period) {
            const now = Date.now();
            let startDate;
            
            if (period === 'today') {
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                startDate = today.getTime();
            } else if (period === 'week') {
                startDate = now - (7 * 24 * 60 * 60 * 1000);
            } else {
                startDate = now - (30 * 24 * 60 * 60 * 1000);
            }
            
            return { startDate, endDate: now };
        }

        function updateEmotionsChart() {
            const emotionStats = JSON.parse(localStorage.getItem('emotionStats')) || [];
            const { startDate, endDate } = getDateRange(currentPeriod);
            
            // Filtrer par pÃ©riode
            const filteredEmotions = emotionStats.filter(e => 
                e.timestamp >= startDate && e.timestamp <= endDate
            );
            
            // Compter les Ã©motions
            const emotionCounts = {};
            filteredEmotions.forEach(e => {
                emotionCounts[e.emotion] = (emotionCounts[e.emotion] || 0) + 1;
            });
            
            // Si on regarde aujourd'hui, grouper par heure
            let chartData;
            if (currentPeriod === 'today') {
                chartData = getEmotionsByHour(filteredEmotions);
            } else {
                chartData = {
                    labels: Object.keys(emotionCounts),
                    data: Object.values(emotionCounts)
                };
            }
            
            const ctx = document.getElementById('emotionsChart');
            
            // DÃ©truire l'ancien graphique s'il existe
            if (emotionsChart) {
                emotionsChart.destroy();
            }
            
            const emotionColors = {
                joyeux: '#FFE66D',
                calme: '#4ECDC4',
                anxieux: '#FF6B6B',
                frustrÃ©: '#FFB84D',
                triste: '#95E1D3',
                dÃ©bordÃ©: '#F38181',
                excitÃ©: '#AA96DA',
                fatiguÃ©: '#C7CEEA'
            };
            
            emotionsChart = new Chart(ctx, {
                type: currentPeriod === 'today' ? 'line' : 'bar',
                data: {
                    labels: chartData.labels,
                    datasets: currentPeriod === 'today' ? 
                        Object.keys(chartData.datasets).map(emotion => ({
                            label: emotion.charAt(0).toUpperCase() + emotion.slice(1),
                            data: chartData.datasets[emotion],
                            borderColor: emotionColors[emotion] || '#999',
                            backgroundColor: (emotionColors[emotion] || '#999') + '40',
                            tension: 0.4,
                            fill: true
                        })) :
                        [{
                            label: 'Nombre de fois',
                            data: chartData.data,
                            backgroundColor: chartData.labels.map(label => emotionColors[label] || '#999')
                        }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            display: currentPeriod === 'today'
                        },
                        title: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    }
                }
            });
        }

        function getEmotionsByHour(emotions) {
            const hours = Array.from({length: 24}, (_, i) => i + 'h');
            const datasets = {};
            
            emotions.forEach(e => {
                const date = new Date(e.timestamp);
                const hour = date.getHours();
                
                if (!datasets[e.emotion]) {
                    datasets[e.emotion] = new Array(24).fill(0);
                }
                datasets[e.emotion][hour]++;
            });
            
            return { labels: hours, datasets };
        }

        function updateTasksChart() {
            const { startDate, endDate } = getDateRange(currentPeriod);
            
            // Filtrer les tÃ¢ches par pÃ©riode
            const filteredTasks = tasks.filter(t => {
                const taskDate = new Date(t.date.split('/').reverse().join('-')).getTime();
                return taskDate >= startDate && taskDate <= endDate;
            });
            
            const completed = filteredTasks.filter(t => t.completed).length;
            const pending = filteredTasks.length - completed;
            
            const ctx = document.getElementById('tasksChart');
            
            if (tasksChart) {
                tasksChart.destroy();
            }
            
            tasksChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['ComplÃ©tÃ©es', 'En cours'],
                    datasets: [{
                        data: [completed, pending],
                        backgroundColor: ['#51CF66', '#FFB84D'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function updateSummaryStats() {
            const { startDate, endDate } = getDateRange(currentPeriod);
            const emotionStats = JSON.parse(localStorage.getItem('emotionStats')) || [];
            
            // TÃ¢ches complÃ©tÃ©es
            const filteredTasks = tasks.filter(t => {
                const taskDate = new Date(t.date.split('/').reverse().join('-')).getTime();
                return t.completed && taskDate >= startDate && taskDate <= endDate;
            });
            document.getElementById('totalTasksCompleted').textContent = filteredTasks.length;
            
            // Ã‰motion dominante
            const filteredEmotions = emotionStats.filter(e => 
                e.timestamp >= startDate && e.timestamp <= endDate
            );
            
            const emotionCounts = {};
            filteredEmotions.forEach(e => {
                emotionCounts[e.emotion] = (emotionCounts[e.emotion] || 0) + 1;
            });
            
            if (Object.keys(emotionCounts).length > 0) {
                const mostFrequent = Object.entries(emotionCounts)
                    .sort((a, b) => b[1] - a[1])[0];
                
                const emotionEmojis = {
                    joyeux: 'ğŸ˜Š',
                    calme: 'ğŸ˜Œ',
                    anxieux: 'ğŸ˜°',
                    frustrÃ©: 'ğŸ˜¤',
                    triste: 'ğŸ˜¢',
                    dÃ©bordÃ©: 'ğŸ¤¯',
                    excitÃ©: 'ğŸ¤©',
                    fatiguÃ©: 'ğŸ˜´'
                };
                
                document.getElementById('emotionMostFrequent').textContent = 
                    emotionEmojis[mostFrequent[0]] + ' ' + mostFrequent[0].charAt(0).toUpperCase() + mostFrequent[0].slice(1);
            } else {
                document.getElementById('emotionMostFrequent').textContent = '-';
            }
        }

        // POINTS D'Ã‰TAPE (MILESTONES)
        function addMilestone() {
            const text = prompt('DÃ©cris ton point d\'Ã©tape ou ton objectif :');
            if (!text || text.trim() === '') return;
            
            const milestones = JSON.parse(localStorage.getItem('milestones')) || [];
            milestones.push({
                id: Date.now(),
                text: text,
                date: new Date().toLocaleString('fr-FR'),
                completed: false
            });
            
            localStorage.setItem('milestones', JSON.stringify(milestones));
            loadMilestones();
        }

        function loadMilestones() {
            const milestones = JSON.parse(localStorage.getItem('milestones')) || [];
            const container = document.getElementById('milestonesList');
            
            if (milestones.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #999;">Aucun point d\'Ã©tape pour le moment. Ajoute-en un !</p>';
                return;
            }
            
            container.innerHTML = milestones.map(m => `
                <div class="milestone-item ${m.completed ? 'completed' : ''}">
                    <div style="flex: 1;">
                        <input type="checkbox" ${m.completed ? 'checked' : ''} 
                               onchange="toggleMilestone(${m.id})" 
                               style="margin-right: 10px; width: 20px; height: 20px; cursor: pointer;">
                        <strong>${m.text}</strong>
                        <div class="milestone-date">${m.date}</div>
                    </div>
                    <button class="delete-btn" onclick="deleteMilestone(${m.id})">ğŸ—‘ï¸</button>
                </div>
            `).join('');
        }

        function toggleMilestone(id) {
            const milestones = JSON.parse(localStorage.getItem('milestones')) || [];
            const milestone = milestones.find(m => m.id === id);
            if (milestone) {
                milestone.completed = !milestone.completed;
                localStorage.setItem('milestones', JSON.stringify(milestones));
                loadMilestones();
            }
        }

        function deleteMilestone(id) {
            if (!confirm('Supprimer ce point d\'Ã©tape ?')) return;
            let milestones = JSON.parse(localStorage.getItem('milestones')) || [];
            milestones = milestones.filter(m => m.id !== id);
            localStorage.setItem('milestones', JSON.stringify(milestones));
            loadMilestones();
        }

        // Chargement initial
        loadTasks();
    </script>
</body>
</html>